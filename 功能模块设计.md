# 功能模块设计

## 1. 控制面板
### 功能要求
- 实时显示所有设备工作状态
- 实时刷新设备状态
- 直接控制设备操作

### 设备控制参数
- **功率设置**：精度1%（PWM设备）
- **时间设置**：精度0.1s
- **定时任务概念**：
  - 阀打开1s = 打开1s后自动关闭
  - 阀关闭1s = 关闭1s后自动打开
  - 0s = 常开/常闭（前端显示为文字，不显示0）

### UI设计要求
- 超越Apple Inc.设计水准
- 清晰直观的设备状态展示
- 流畅的交互动画

## 2. 任务编排器
### 任务结构设计
```
步骤1 {
    普通动作1,2,3... +        // 单次执行的动作
    并行循环1 {               // 可设置循环次数和间隔
        子步骤1 { 动作1,2,3... }
        子步骤2 { 动作1,2,3... }
        ...
    } +
    并行循环2 { ... } +
    ...
}
→ 步骤2 { ... }
→ ...
```

### 关键特性
- **并行执行**：同一步骤内的所有动作和循环同时开始
- **循环独立性**：每个循环有独立的执行进度
- **不支持循环嵌套**：子步骤不能再包含循环
- **循环配置**：循环次数 + 循环间隔

### 任务执行逻辑
- **后端统筹**：电脑后端负责任务解析和调度
- **精度保证**：0.1s时间精度
- **状态跟踪**：实时跟踪每个循环的执行进度
- **Arduino专注**：Arduino只处理瞬时设备控制

### 交互设计
- **编辑界面**：清晰的步骤/循环/动作层级编辑
- **实时预览**：页面底部总览预览，支持折叠/展开
- **预览换行**：避免一长条显示，合理换行布局

### 数据持久化
- **导出功能**：支持任务配置导出
- **导入功能**：支持任务配置导入
- **页面切换**：切换到其他页面不丢失编辑内容

## 3. 日志系统
### 日志分类
- **后端日志**：服务器运行状态、任务执行记录
- **前端日志**：用户操作记录、界面状态变化
- **Arduino日志**：设备控制指令、硬件状态

### 显示要求
- 分别切换查看三类日志
- 清晰的时间戳和日志级别
- 支持日志搜索和过滤
