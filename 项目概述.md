# 项目概述 - Manta Control Ultra

## 项目目标
开发一个基于Arduino UNO R4 WiFi的设备控制系统，支持多设备访问和可配置框架。

## 硬件配置
### Arduino UNO R4 WiFi 规格
- 主控：Renesas RA4M1 (Arm Cortex-M4, 48MHz)
- WiFi：ESP32-S3 (最高240MHz)
- 数字引脚：14个，模拟引脚：6个，PWM：6个
- 工作电压：5V，IO输出电流：8mA
- 存储：256KB Flash, 32KB RAM

### 控制设备定义
```cpp
const int INFLATE_PUMP_1 = 5;    // 充气泵1 (PWM, 0-100%, 精度1%)
const int INFLATE_PUMP_2 = 6;    // 充气泵2 (PWM, 0-100%, 精度1%)
const int EXHAUST_PUMP_1 = 10;   // 抽气泵1 (PWM, 0-100%, 精度1%)
const int EXHAUST_PUMP_2 = 11;   // 抽气泵2 (PWM, 0-100%, 精度1%)
const int VALVE_1 = 2;           // 电磁阀1 (Digital, 5V/0V)
const int VALVE_2 = 4;           // 电磁阀2 (Digital, 5V/0V)
```

## 网络架构
### 双连接模式支持
1. **WiFi模式**：Arduino创建WiFi热点："FishControl_WiFi" (密码: "fish2025")
2. **串口模式**：通过USB串口直接连接控制
3. 电脑作为后端服务器，运行在fish:8080
4. 支持1台电脑+3台手机同时连接
5. 需要mDNS和DNS支持，确保设备能访问fish:8080
6. WiFi连接要求：100小时连续工作稳定性

### 智能连接功能
- **串口智能识别**：自动识别Arduino板子型号
- **WiFi智能连接**：用户友好的一键连接
- **网络状态检测**：智能检测用户联网状况
- **一键断网功能**：后端电脑支持一键断开当前WiFi连接

## 技术栈选择
### 前端
- **React + TypeScript + Vite**：现代化开发，类型安全
- **Tailwind CSS + Framer Motion**：精美UI + 流畅动画
- **PWA支持**：手机端接近原生体验
- **响应式设计**：适配手机/平板/电脑

### 后端
- **Node.js + Express + TypeScript**：与前端技术栈统一
- **Socket.io**：实时通信，设备状态同步
- **SQLite**：轻量级数据库，存储配置和日志

### Arduino端
- **C++**：标准Arduino开发
- **WiFi热点 + HTTP服务器**：接收控制命令
- **PWM默认频率**：490Hz（可配置）

## 冲突处理机制
- 50ms内同设备多命令只接受第一个（后端处理）
- 确保设备状态一致性和安全性
